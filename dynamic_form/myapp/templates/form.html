<!DOCTYPE html>
<html>
    <head>
        <title>Dynamic Form</title>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <style>
            /* Add your CSS styling here */
        </style>
    </head>
    <body>
        <div id="dynamic-form-container"></div>
        <script type="text/javascript">
            $(document).ready(function() {
                var tasksSchema = {{ tasks_schema|safe }};

                function createFormElements(schema) {
                    var formHtml = '<form id="dynamic-form">';
                    var requiredFields = schema.required || [];

                    for (var key in schema.properties) {
                        var field = schema.properties[key];
                        var isRequired = requiredFields.includes(key);
                        var fieldId = 'field-' + key;

                        // Initial visibility based on 'required' and 'dependencies'
                        var isVisible = isRequired || (schema.dependencies && schema.dependencies[key]);

                        formHtml += '<div class="form-group"' + (isVisible ? '' : ' style="display: none;"') + ' id="' + fieldId + '">';
                        formHtml += '<label for="' + key + '">' + field.description + '</label>';

                        switch (field.type) {
                            case 'string':
                                formHtml += '<input type="text" id="' + key + '" name="' + key + '" class="form-control"><br>';
                                break;
                            case 'boolean':
                                formHtml += '<input type="checkbox" id="' + key + '" name="' + key + '" class="form-check-input"><br>';
                                break;
                            // Add other types as needed
                        }
                        formHtml += '</div>';
                    }

                    formHtml += '<input type="submit" value="Submit" class="btn btn-primary"></form>';
                    return formHtml;
                }

                var formHtml = createFormElements(tasksSchema);
                $('#dynamic-form-container').html(formHtml);

                // Add event listeners for dependency handling
                handleDependencies(tasksSchema);
            });

            function handleDependencies(schema) {
                if (schema.dependencies) {
                    for (var key in schema.dependencies) {
                        $('#' + key).change(function() {
                            var dependentFields = schema.dependencies[this.id];
                            dependentFields.forEach(function(dependentKey) {
                                $('#field-' + dependentKey).toggle(this.checked);
                            });
                        });
                    }
                }

                // Add additional logic for 'if', 'then', 'else' conditions
                // This can be complex depending on your schema structure
            }
        </script>
    </body>
</html>
